var smartsearchIdArray=new Array();var smartsearchUnitArray=new Array();var smartsearchArray=new Array();var ingredientSearchArray=new Array();var allRecipesResult=[];$(document).ready(function(){favoriteButtons();window.upButton=new UpButton();DoYouKnowThat("do-you-know-that");$(".recipe, .topic_item").addtocopy({htmlcopytxt:'<br>Подробнее: <a href="'+window.location.href+'">'+window.location.href+"</a>",minlen:50,addcopyfirst:false});$.cookie("gogogo",null);$(".input_file").each(function(){new InputFile($(this))});$(".b-recipe-menu__button__type-print").click(function(){openPrintWindow($(this));return false});$(document).bind("click",function(){$("#top_search_list").children("ul").css({display:"none"});$("#top_panel span.kitchen > span.submenu").slideUp("middle").siblings("a").children("span").addClass("up").removeClass("down");$("#top_panel div.add span.body").slideUp("middle");$("#filter_list:visible").slideUp("fast",function(){$("#filter_recipes .open").removeClass("open")})});buttonActions();$("#comment_form textarea").resizeTextarea();new FilterRecipes();$(".b-filter").each(function(){new Filter($(this))});new FilterList();new SearchRecipeFeed();valignRecipePreviewPhoto();$(".recipe #html_code").click(function(){var c=window.open("","HTMLcode","width=800, height=800,toolbar=0,scrollbars=yes,status=0,directories=0,location=0,menubar=0,resizable=0");var i="",f="",d=$("div.title div.needed span.ingredient"),e=$("div.title div.needed td.ing_amount"),h=$("div.stage");d.each(function(){i+=this.innerHTML+"&amp;nbsp;&amp;nbsp;&amp;nbsp;"+e[d.index(this)].innerHTML+"&lt;br /&gt;"});h.each(function(){var j="",l=$(this).find("td.ing_name"),k=$(this).find("td.ing_amount"),m="";l.each(function(){m+=this.innerHTML+"&amp;nbsp;&amp;nbsp;&amp;nbsp;"+k[l.index(this)].innerHTML+"&lt;br /&gt;"});if($(this).find("img.photo").is("img")){j='&lt;br /&gt;&lt;br /&gt;&lt;img src="http://www.foodclub.ru'+$(this).find("img.photo").attr("src")+'" /&gt'}f+=Number(h.index(this)+1)+". "+m+$(this).find("div.instruction").text()+j+"&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;"});var g='&lt;img src="http://www.foodclub.ru'+$("img.final-photo").attr("src")+'" /&gt;&lt;br /&gt;&lt;br /&gt;'+$("div.description").text()+'&lt;br /&gt;&lt;br /&gt;&lt;a href="http://www.foodclub.ru/detail/'+$("div.hrecipe").attr("id")+'/" target="_blank"&gt;Постоянный адрес рецепта&lt;/a&gt; на foodclub.ru&lt;br /&gt;&lt;br /&gt;&lt;lj-cut text="Читать подробности"&gt;&lt;br /&gt;&lt;br /&gt;Состав&lt;br /&gt;&lt;br /&gt;'+i+"&lt;br /&gt;	&lt;br /&gt;&lt;br /&gt;"+f+"&lt;/lj-cut&gt;";c.document.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1251" /><title>HTML-код</title></head><body><textarea cols="80" rows="40">'+g+"</textarea></body></html>");c.document.getElementByTag("TEXTAREA").select();return false});$(".topic_item #html_code").click(function(){var d=$(".topic_item"),g=window.open("","HTMLcode","width=800, height=800, toolbar=0, scrollbars=yes, status=0, directories=0, location=0, menubar=0, resizable=0"),i=d.find("h1").text(),h=d.find(".text"),e=$("<div></div>");e.html(h.html());e=f(e);var j=c(e);g.document.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1251" /><title>HTML-код</title></head><body><textarea cols="80" rows="40">'+j+"</textarea></body></html>");return false;function f(k){k.find("[src]").each(function(){var l=$(this).attr("src");if(/^http/i.test(l)){return}$(this).attr({src:window.location.protocol+"//"+window.location.hostname+l})}).find("[href]").each(function(){var l=$(this).attr("href");if(/^http/i.test(l)){return}$(this).attr({href:window.location.protocol+"//"+window.location.hostname+l})});return k}function c(k){var m=k.find('[name="cut"]');if(m.size()==0){return k.html()}m.before("<lj-cut></lj-cut>").remove();var l=k.html();l+="";l=l.split("</lj-cut>");l=l[0]+l[1]+"</lj-cut>";return l}});$("div.needed div.scales").click(function(){window.open("/table/","scalesWin","width=800, height=800,toolbar=0,scrollbars=yes,status=0,directories=0,location=0,menubar=0,resizable=0");return false});$("#top_panel span.kitchen > a").click(function(c){$(this).siblings("span.submenu").slideToggle("middle").end().children("span").toggleClass("up").toggleClass("down");stopEvent(this,c);return false});$("#top_panel div.add > a.button").click(function(c){$(this).siblings("span.submenu").children("span.body").slideToggle("middle");stopEvent(this,c);return false});$("div.share > a").click(function(){$(this).closest("div.bar").next("div.share_bar").slideToggle("middle");$(this).parent().toggleClass("open");return false});$("input.button_obj").hover(function(){$(this).addClass("button_obj_hover")},function(){$(this).removeClass("button_obj_hover")});$("input.button_obj").mousedown(function(){$(this).addClass("button_obj_press")});if(String(window.location).search("#add_opinion")!=-1){$("#opinion_form").find("textarea").focus()}$("a[href='#add_opinion']").click(function(){$("#opinion_form").find("textarea").focus();return false});$("#search_list_layer div.relative div.close_icon").click(function(){showHideLayer("top_layer");showHideLayer("search_list_layer");$("#search_list_layer div.relative div.padding div.column").empty()});$("#search_list_layer div.relative div.padding div.button").click(function(){writeChosenItems(this);showHideLayer("top_layer");showHideLayer("search_list_layer");$("#search_list_layer div.relative div.padding div.column").empty();document.getElementById("recipe_search_field").focus()});$("#recipe_line_block").find("div.big_photo").each(function(){$(this).appendTo($("#big_recipe_photos"))});$(document).delegate("div.photo, div.author_photo","mouseenter",function(){$(this).children("div.big_photo").css({display:"block"})}).delegate("div.photo, div.author_photo","mouseleave",function(){$(this).children("div.big_photo").css({display:"none"})});$("#recipe_line_block").find("div.photo").children("img").mouseover(function(){var c="-121px";var d=pageX(this)-pageX(document.getElementById("recipe_line_block"))-12;$("#"+$(this).parent().attr("id")+"_big").children("div").css({top:c,left:d});$("#"+$(this).parent().attr("id")+"_big").css({display:"block"})});$("#recipe_line_block").find("div.big_photo").hover(function(){},function(){$(this).animate({opacity:"hide"},"fast")});$("div.search_field form input.button").click(function(){searchForm(this);return false});$("div.search_field div.search_delete").click(function(){$(this).siblings("form").children("input.text").attr({value:""});$("#recipe_search_field").focus();$("#top_search_list").children("ul").css({display:"none"})});$("#recipe_search_field").focus(function(){if(this.value=="Я ищу"){this.value=""}});$("#recipe_search_field").blur(function(){if(this.value==""){this.value="Я ищу"}});$("#authorization_layer div.relative div.padding div.button").click(function(){checkALayer(this)});$("#authorization_layer div.relative div.padding div.bar div a").click(function(){var c=$(this).parent().parent().parent().children("div.body").children("div.act");$(c).removeClass("act");$(c).slideUp("middle");$(c).find("div.form_field").removeClass("attention").children("input").attr({value:""});$(c).find("div.form_field").children("input[name='open_id']").attr({value:"http://"});$(this).parent().parent().children("div.act").removeClass("act");$(this).parent().addClass("act");$("#"+$(this).attr("rel")).addClass("act");$("#"+$(this).attr("rel")).slideDown("middle");$("#"+$(this).attr("rel")).find("div.fields").find("input:eq(0)").focus();return false});$("#authorization_layer div.relative div.close_icon").click(function(){showHideLayer("top_layer");showHideLayer("authorization_layer")});$("#form div.button_authorization").click(function(){checkAForm(this)});$("#form div.authorization").find("input.text").keypress(function(c){if(c.which==13){checkAForm(this)}});$("#form div.lj_id").find("input.text").keypress(function(c){if(c.which==13){checkAForm(this)}});$("#form div.open_id").find("input.text").keypress(function(c){if(c.which==13){checkAForm(this)}});$("#form div.authorization form div div.remember a").click(function(){if(this.parentNode.className.search("chosen")!=-1){$(this).parent().removeClass("chosen");$(this).siblings("input").attr({value:"N"})}else{$(this).parent().addClass("chosen");$(this).siblings("input").attr({value:"Y"})}return false});$("#form div h2 a").click(function(){var c=$(this).parent().parent().parent().children("div.act").removeClass("act");$(c).find("div.fields").slideUp("middle");$(c).find("div.form_field").removeClass("attention").children("input").attr({value:""});$(c).find("div.form_field").removeClass("attention").children("input[name='open_id']").attr({value:"http://"});$(this).parent().parent().addClass("act");$(this).parent().parent().find("div.fields").slideDown("middle");return false});$("#form").find("div.button").click(function(){checkForm(this)});$("input.text").keypress(function(c){if(c.which==13){if($(this).attr("id")=="helper_smartsearch"){return false}else{if($(this).attr("id")=="recipe_search_field"){return false}else{if($(this).parents("#dish_stages").size()!=0){if($(this).hasClass("unit")){if($(this).attr("value")!=""){if($(this).closest("div.item").next("div.item").size()!=0){$(this).closest("div.item").next("div.item").find("input.smartsearch").focus()}else{$(this).closest("div.ingredient").find("div.add_ingredient").children("a").click()}}}else{$(this).siblings("div.search_list").children("ul").css({display:"none"}).empty();showUnitField(this)}return false}else{if($(this).hasClass("smartsearch")){return false}else{if(!$(this).attr("name")||$(this).parents("form").attr("name")=="authorization"||$(this).parents("form").attr("name")=="open_id"){checkALayer(this)}else{checkForm(this);return false}}}}}}});$("#opinion_block").find("div.edit").click(function(){$("#opinion_block").find("div.opinion").removeClass("edit_form");$(this).parents("div.opinion").addClass("edit_form")});$("#opinion_block, #comment_form").find("div.button").click(function(){checkForm(this)});$("#opinion_form").find("textarea").keyup(function(f){var g=this.parentNode;for(var d=0;d<g.childNodes.length;d++){if(g.childNodes[d].className.search("button")!=-1){var c=g.childNodes[d]}}if(f.ctrlKey&&f.keyCode==13){checkForm(c)}}).keydown(function(f){var g=this.parentNode;for(var d=0;d<g.childNodes.length;d++){if(g.childNodes[d].className.search("button")!=-1){var c=g.childNodes[d]}}if(f.ctrlKey&&f.keyCode==13){checkForm(c)}});$("#opinion_block").find("div.delete").click(function(){if(!confirm("Удалить отзыв?")){return false}else{var e=$(this).parents("div.opinion").attr("id");var d=$("#text_space").children("div.recipe").attr("id");var c=String(window.location).split(document.domain)[0]+document.domain+"/comment.php?cId="+e+"&rId="+d+"&a=d";window.location.href=c}});$("#opinion_block div.close_icon").click(function(){$(this).parents("div.opinion").removeClass("edit_form")});$("div.comments_block").delegate("div.reply_string a","click",function(){if($(this).hasClass("i-open")){$("#reply_form div.close_icon div").click();return false}$("div.comments_block div.comment").removeClass("edit_form");$("div.comments_block div.reply_string a").text("Ответить").removeClass("i-open");$("#reply_form").hide().remove().insertAfter($(this).parent().parent().parent().parent()).slideDown("middle");$("#reply_form div.close_icon div").unbind("click").click(function(){$("#reply_form").prev().find("div.reply_string a").text("Ответить").removeClass("i-open");$("#reply_form").slideUp("middle").find("h4").removeClass("attention")});$("#reply_form .button").click(function(){if($(this).hasClass("i-sent")){return false}$(this).addClass("i-sent");if($("#reply_form textarea").val()!=""){$("#reply_form form").submit()}else{$("#reply_form h4").addClass("attention");return false}}).hover(function(){$(this).addClass("button_hover")},function(){$(this).removeClass("button_hover")}).mousedown(function(){$(this).addClass("button_active")}).mouseup(function(){$(this).removeClass("button_active")});$("#reply_form textarea").val("").keyup(function(d){if(d.ctrlKey&&d.keyCode==13){if($(this).attr("value")!=""||$(this).text()!=""){$("#reply_form").children("form").submit()}else{return false}}}).keydown(function(d){if(d.ctrlKey&&d.keyCode==13){if($(this).attr("value")!=""||$(this).text()!=""){$("#reply_form").children("form").submit()}else{return false}}}).resizeTextarea();$(this).text("Скрыть").addClass("i-open");var c=$(this).parents("div.comment").attr("id");$("#reply_form").find("input[name='parentId']").attr({value:c});return false}).delegate("div.edit","click",function(){$("div.comments_block").find("div.edit_form").removeClass("edit_form");$(this).parents("div.comment").addClass("edit_form").find("textarea").resizeTextarea();$("div.comments_block").find("div.reply_string").css({visibility:"visible"});$("#reply_form").slideUp("middle")}).delegate("div.close_icon","click",function(){$(this).parents("div.comment").removeClass("edit_form")}).delegate("div.button","click",function(){checkForm(this)}).delegate("div.button","click",function(){checkForm(this)}).delegate("textarea","keyup",function(f){var g=this.parentNode;for(var d=0;d<g.childNodes.length;d++){if(g.childNodes[d].className.search("button")!=-1){var c=g.childNodes[d]}}if(f.ctrlKey&&f.keyCode==13){checkForm(c)}}).delegate("textarea","keydown",function(f){var g=this.parentNode;for(var d=0;d<g.childNodes.length;d++){if(g.childNodes[d].className.search("button")!=-1){var c=g.childNodes[d]}}if(f.ctrlKey&&f.keyCode==13){checkForm(c)}}).delegate("div.delete","click",function(){if(!confirm("Удалить комментарий?")){return false}else{var d=$(this).closest(".comment").attr("id");var c=String(window.location).split("?")[0]+"?delete_comment_id="+d+"&sessid="+$("#sessId").text()+"";window.location.href=c}});$("#personal_bar div.item a").click(function(){$("#personal_bar").children("div.act").removeClass("act");$(this).parent().addClass("act");return false});var a=0;$("#left_menu").find("div.switch").find("a").click(function(){$("#left_menu").find("ul.list").removeClass("act");$("#"+$(this).attr("rel")).addClass("act");$(this).parent().parent().children("div").removeClass("act");$(this).parent().addClass("act");return false});$("div.pager").children("div.pointer").hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")});$("#club_search_field").focus(function(){if(this.value=="Найти клуб"){this.value=""}});$("#club_search_field").blur(function(){if(this.value==""){this.value="Найти клуб"}});$("#add_post_form").find("div.button").click(function(){document.getElementById("add_post_form").submit()});$("#user_list").find("div.button").click(function(){document.getElementById("user_list").submit()});$("#edit_form").find("div.button").click(function(){checkForm(this)});$("#setup_form").find("div.button").click(function(){checkForm(this)});$("div.form_checkbox_pic img").click(function(){activateCheckbox(this)});$("div.form_checkbox_pic span").click(function(){activateCheckbox(this)});$("#edit_avatar").click(function(){$(this).parent("form").submit()});$("#save_recipe").click(function(){checkStageForm();return false});if($.placeholder){$("#helper_smartsearch").placeholder()}$("#search_helper_link").click(function(){showHideLayer("top_layer");$("#search_helper div.body div.menu div.item").removeClass("act");$("#search_helper div.body div.menu div.item:eq(0)").addClass("act");$("#search_helper div.body div.search_blocks").css({display:"none"});$("#h_helper").css({display:"block"});$("#i_have_list div.bg table").empty();$("#i_have_dash").css({display:"block"});$("#search_helper").css({top:"0"}).removeClass("stage_helper").slideDown("middle");return false});$("#search_helper div.body div.slide_up_button").click(function(){$("#search_helper").slideUp("middle",function(){showHideLayer("top_layer")})});$("#search_helper div.body div.menu div.item a").click(function(){$("#search_helper div.body div.search_blocks").css({display:"none"});$("#"+$(this).attr("rel")).css({display:"block"});$(this).parent().parent().children("div.item").removeClass("act");$(this).parent().addClass("act");if($(this).attr("rel")=="h_ingredients"){$("#i_have_ingredients_list div.column ul").empty();$("#i_have_ingredients_list h2").empty();createGroupList()}return false});$("#i_have_button").click(function(){var c="/search/";$(this).parent().find("tr").each(function(){c+=$(this).find("span").text().toLowerCase()+"/"});window.location.href=c});$("#helper_smartsearch").focus(function(){if(this.value==""){this.value=""}});$("#helper_smartsearch").blur(function(){if(this.value==""){this.value=""}});var b=0;$("#helper_smartsearch").keyup(function(c){if(window.event){c=window.event}switch(c.keyCode?c.keyCode:c.which?c.which:null){case 38:if(b==0){smartsearchNavUp(this)}break;case 40:if(b==0){smartsearchNavDown(this)}break;default:smartsearchFunction(this)}});$("#helper_smartsearch").keypress(function(c){if(window.event){c=window.event}switch(c.keyCode?c.keyCode:c.which?c.which:null){case 38:b=1;smartsearchNavUp(this);break;case 40:b=1;smartsearchNavDown(this);break;case 13:b=0;pressEnter();break}})});function UpButton(){var b=this;h();function h(){if(!document.getElementById("top_panel")||!document.getElementById("body")){return}c();f();a();e();$(window).scroll().resize();$(document).mousemove()}function c(){$("body").prepend('<div id="upButton"><span class="b-up-button__up">Наверх</span><span class="b-up-button__down">Обратно</span></div>');$("body").prepend('<div id="upButtonClickable"></div>')}function f(){b.scrolled=g();b.memory=0;b.$elem=$("#upButton");b.$elem.data("object",b);b.$clickable=$("#upButtonClickable")}function a(){i();j();function i(){var l=$("#top_panel").offset().top+$("#top_panel").height()+50-b.scrolled;var k=$("#body").offset().left-100;b.$elem.css({top:l,left:k})}function j(){var n=$("#top_panel").offset().top+$("#top_panel").height()-b.scrolled;var m=0;var l=$("#body").offset().left-25;b.$clickable.css({height:$("#body").height()});var k=$(document).height()-n;if(l<0){l=0}b.$clickable.css({top:n,left:m,width:l,height:k})}}function g(){return window.pageYOffset||document.documentElement.scrollTop}function e(){$(window).scroll(i).resize(j);b.$clickable.click(n);$(document).mousemove(l);function l(o){if(b.scrolled<200){m()}if(o.pageX){b.pageX=o.pageX}if(!b.pageX){return}if((b.pageX<b.$clickable.width()&&b.scrolled>200)||(b.pageX<b.$clickable.width()&&b.scrolled==0&&b.memory!=0)){k()}else{m()}}function k(){if(b.memory!=b.scrolled){b.$clickable.addClass("i-visible")}}function m(){b.$clickable.removeClass("i-visible")}function n(){o();function o(){var p=b.memory;b.memory=b.scrolled;$.scrollTo(p)}}function i(o){b.scrolled=g();d();l(o);if(!b.$elem.hasClass("i-reverse")){b.memory=0}}function j(o){a();l(o)}}function d(){if(b.scrolled>200){b.$elem.addClass("i-visible");b.$elem.removeClass("i-reverse")}else{if(b.memory!=0){b.$elem.addClass("i-reverse")}else{b.$elem.removeClass("i-visible");b.$elem.removeClass("i-reverse")}}}this.styleElements=function(){a()}}function SearchRecipeFeed(){var b=this;f();function f(){e();d()}function e(){b.$statistics=$("#fc_statistics");b.$getMoreButton=$("#get_more_recipes");b.recipesPerPage=27}function d(){b.$getMoreButton.click(a)}function a(){var g=[];for(var h=0;h<b.recipesPerPage;h++){if(allRecipesResult[0]){g[h]=allRecipesResult.shift()}}$.ajax({url:"/php/get_more_recipes.php",dataType:"json",data:"id="+g,beforeSend:function(){$("#get_more_recipes").addClass("preload")},success:function(m){$("#get_more_recipes").removeClass("preload");var n=$('<div class="block" style="display:none;"></div>');var k="";for(var j=0;j<m.recipes.length;j++){k+='<div class="item recipe_list_item"><div class="photo"><a href="'+m.recipes[j].href+'" title="'+m.recipes[j].name+'"><img src="'+m.recipes[j].src+'" width="170" alt="'+m.recipes[j].name+'" /></a></div><h5><a href="'+m.recipes[j].href+'">'+m.recipes[j].name+'</a></h5><p class="author">От: '+m.recipes[j].author+'</p><p class="info"><span class="comments_icon" title="Оставить отзыв"><noindex><a href="'+m.recipes[j].href+'#comments">'+m.recipes[j].comments+"</a></noindex></span></p></div>"}n.html(k);$("#recipe_feed_block").find("div.clear").before(n).end().find("div.block:last div.recipe_list_item div.photo a").each(function(){var p=$(this),o=p.children("img"),i=new Image();i.src=o.attr("src");var q=Math.floor(i.height*o.attr("width")/i.width);if(q>0){o.css({marginTop:(parseInt(p.css("height"))/2-q/2)+"px"})}else{o.load(function(){var r=Math.floor(i.height*o.attr("width")/i.width);if(r>0){o.css({marginTop:(parseInt(p.css("height"))/2-r/2)+"px"})}})}}).end().find("div.block:last").css({opacity:0}).show().animate({opacity:1},500);$.scrollTo($("#recipe_feed_block div.block:last div.item:first"),1000);l();window.upButton.styleElements();function l(){var i=allRecipesResult.length;if(i==0){$("#get_more_recipes").hide()}else{$("#get_more_recipes").show()}}}});return false}function c(h){b.$statistics.find("span.num").text(h).end().find("span.word").text(g(h));function g(i){if(/(10|11|12|13|14|15|16|17|18|19)$/.test(i)){return"рецептов"}else{if(/.*1$/.test(i)){return"рецепт"}else{if(/[2-4]$/.test(i)){return"рецепта"}else{return"рецептов"}}}}}}function buttonActions(){$(".button").mousedown(function(){$(this).addClass("button_active")}).mouseup(function(){$(this).removeClass("button_active")}).hover(function(){$(this).addClass("button_hover")},function(){$(this).removeClass("button_hover")})}function deleteStageImage(a,b){deleteConfirm=1;if(confirm("Удалить?")){window.location.href=window.location+"?id="+b}else{$(a).css({backgroundPosition:"left top"});deleteConfirm=0}}function InputFile(b,c){var j=this;j.$elem=b;j.$input=j.$elem.find(":file");var l={},c=c||{};l.extentions=c.extentions||["jpg","jpeg"];l.messages=c.maessages||{wrongExtention:"Загружайте изображения в jpeg формате"};i();function i(){e();j.$name=j.$elem.find("div.new_file_name");j.$input.change(function(){a()})}function d(){j.$elem.find(":file").remove();j.$elem.find(".browse_button").after(j.$input)}function e(){j.$elem.html('<div class="browse_button" title="Выбрать файл"></div><div class="blocker"></div><div class="new_file_name"></div>');j.$elem.find(".browse_button").after(j.$input)}function a(){var m=k();var n=g(m);if(f(n)){j.$name.text(m);j.$name.removeClass("i-attention")}else{j.$name.text(l.messages.wrongExtention);j.$name.addClass("i-attention")}j.$name.css({display:"block"})}function h(m){var n=this.window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):new XMLHttpRequest();if(!n){throw new Error("XMLHttpRequest not supported")}n.open("HEAD",m,false);n.send(null);if(!n.getResponseHeader){try{throw new Error("No getResponseHeader!")}catch(p){return false}}else{if(!n.getResponseHeader("Content-Length")){try{throw new Error("No Content-Length!")}catch(o){return false}}else{return n.getResponseHeader("Content-Length")}}}function f(n){var m=false;for(var o=0;o<l.extentions.length;o++){if(n.toLowerCase()==l.extentions[o]){m=true}}return m}function g(m){var o=/.*\.(.*)/;var n=m.replace(o,"$1");return n}function k(){var n=j.$input.val();reWin=/.*\\(.*)/;var m=n.replace(reWin,"$1");reUnix=/.*\/(.*)/;m=m.replace(reUnix,"$1");if(m.length>18){m="..."+m.substr(m.length-16,16)}return m}}function checkAForm(b){var a=0;var c=$("#form div.act");$(c).find("input[type!='hidden']").each(function(){if($(this).attr("value")==""){a=1;$(this).parent().addClass("attention")}else{$(this).parent().removeClass("attention")}});if(a==0){var d=$(c).children("form");if($(d).attr("name")=="lj_id"){var e=$(c).children("div.fields").find("input").attr("value");$(d).find("input").attr({value:"http://"+e+".livejournal.com"})}if($(d).attr("name")=="open_id"&&$(d).find("input").attr("value")=="http://"){return false}d.submit()}}function checkALayer(b){var a=0;var c=$("#authorization_layer div.relative div.padding div.act");$(c).find("input[type!='hidden']").each(function(){if($(this).attr("value")==""){a=1;$(this).parent().addClass("attention")}else{$(this).parent().removeClass("attention")}});if(a==0){var d=$(c).children("form");if($(d).attr("name")=="lj_id"){var e=$(c).children("div.fields").find("input").attr("value");$(d).find("input").attr({value:"http://"+e+".livejournal.com"})}if($(d).attr("name")=="open_id"&&$(d).find("input").attr("value")=="http://"){return false}d.submit()}}function searchForm(e){if(document.getElementById("recipe_search_field").value!=""){if(document.getElementById("recipe_search_field").value!="Я ищу"){if($(e).hasClass("button")){var d=new String($(e).siblings("input.text").attr("value"))}if($(e).hasClass("text")){var d=new String($(e).attr("value"))}var b=d.split(", ");var c=b.join("/");var a=String(window.location).split(document.domain)[0]+document.domain+"/search/"+c+"/";window.location.href=a}}}function checkForgetForm(){var e=$("#form").find("form");var a=$("form").find("input[name='login']");var d=$("form").find("input[name='e-mail']");if($(a).attr("value")!=""){e.submit()}else{if($(d).attr("value")!=""){var b=$(d).attr("value");var c=/^([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})$/i;if(!b.match(c)){$(d).parent().addClass("attention")}else{e.submit()}}}}function checkForm(d){if($(d).hasClass("i-sent")){return false}$(d).addClass("i-sent");if($(d).hasClass("i-processing")){return false}if(d.className=="text"&&!d.getAttribute("name")){if($(d).attr("value")==""&&$(d).parent().children("h5").children("span").text()!=""){$(d).parent().addClass("attention")}else{var c=$(d).parents("div.open_id").children("form");var e=$(d).attr("value");$(c).find("input").attr({value:"http://"+e+".livejournal.com"});c.submit()}}if((d.className=="text"&&d.getAttribute("name"))||(d.className.search("button")!=-1)){var b=$(d).closest("form");if(b.attr("name")=="forget"){checkForgetForm()}else{var a=0;b.find("input[type!='hidden']").each(function(){if($(this).attr("value")==""&&$(this).parent().children("h5").children("span").text()!=""){if(this.getAttribute("name")&&this.getAttribute("name").search("PASSWORD_CONFIRM")!=-1){var i=this;var h;b.find("input[name*='PASSWORD']").each(function(){if(this!=i){h=this}});if($(h).attr("value")!=""){$(this).parent().addClass("attention");a=1}else{$(this).parent().removeClass("attention")}}else{a=1;$(this).parent().addClass("attention")}}else{if($(this).attr("name").search("mail")!=-1||$(this).attr("name").search("MAIL")!=-1){var f=$(this).attr("value");var g=/^([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})$/i;if(!f.match(g)){$(this).parent().addClass("attention");a=1}else{$(this).parent().removeClass("attention")}}else{if(this.getAttribute("name")&&this.getAttribute("name").search("PASSWORD_CONFIRM")!=-1){var i=this;var h;b.find("input[name*='PASSWORD']").each(function(){if(this!=i){h=this}});if($(this).attr("value")!=$(h).attr("value")){$(this).parent().addClass("attention");a=1}else{$(this).parent().removeClass("attention")}}else{$(this).parent().removeClass("attention")}}}});b.find("textarea").each(function(){if($(this).val()==""&&$(this).closest(".form_field").find("h4 span").text()!=""){a=1;$(this).closest(".form_field").addClass("attention")}});if(a==0){if($(d).hasClass("button")||$(d).hasClass("b-button")){$(d).addClass("i-processing")}b.submit()}}}}function showHideLayer(c){var b=document.getElementById(c);if(b.style.display=="none"){b.style.display="block";if(c=="top_layer"){b.style.height=getyScroll()+"px";for(var a=0;a<b.childNodes.length;a++){if(b.childNodes[a].tagName=="IFRAME"){b.childNodes[a].style.height=getyScroll()+"px";b.childNodes[a].style.width="100%"}}}else{var e=$(b).height();if($(b).find("div.padding").height()!=""){e=$(b).find("div.padding").height()}if(document.documentElement.clientHeight>e){var d=(document.documentElement.clientHeight)/2+$(window).scrollTop()-e/2-20+"px"}else{var d=$(window).scrollTop()+20+"px"}if(c=="ingredients_list_layer"||c=="stage_ingredients_list_layer"){var d=$(window).scrollTop()+20+"px"}$("#"+c).animate({top:d},500,function(){$("#top_layer").height($(document).height()+30);$("#top_layer iframe").height($(document).height()+30)})}}else{b.style.display="none"}}function getyScroll(){var a=0;if(window.innerHeight&&window.scrollMaxY){a=window.innerHeight+window.scrollMaxY;var b=document.documentElement;var c=(b&&b.clientHeight)||document.body.clientHeight||window.innerHeight||self.innerHeight;a-=(window.innerHeight-c)}else{if(document.body.scrollHeight>document.body.offsetHeight){a=document.body.scrollHeight}else{a=document.body.offsetHeight}}return a}function writeChosenItems(a){}function increaseTopLayer(){var a=new String($("#ingredients_list_layer").css("top"));var c=parseInt(a.substring(0,a.length-2));var b=$("#ingredients_list").height()+140+c;if($("#top_layer").height()<b){$("#top_layer").height(b);$("#top_layer iframe").height(b)}else{$("#top_layer").height(getyScroll());$("#top_layer iframe").height(getyScroll())}}function addRemoveClass(b,c){var d=c;var a=new String(b.className);if(a.search(d)!=-1){a=a.split(d).join("")}else{a=a+" "+d}a=a.split("  ").join(" ");if(a.slice(0,1)==" "){a=a.slice(1,a.length)}if(a.slice(a.length-1)==" "){a=a.slice(0,a.length-1)}b.className=a}function checkNumberField(b){var a=b.value;if(a!=""){var c=/([\d.,/])$/i;if(!a.match(c)){b.value=a.slice(0,a.length-1);checkNumberField(b)}}}function clearArray(c){var b=c.length;for(var a=0;a<b;a++){c.pop()}}function activateCheckbox(c){var b=$(c).parent().children("img");var a=new String($(b).attr("src"));var d=$(c).parent().children("input");if(a.search("_act")!=-1){$(b).attr({src:"/images/checkbox.gif"});$(d).attr({value:"N"})}else{$(b).attr({src:"/images/checkbox_act.gif"});$(d).attr({value:"Y"})}}function pageX(a){return a.offsetParent?a.offsetLeft+pageX(a.offsetParent):a.offsetLeft}function pageY(a){return a.offsetParent?a.offsetTop+pageY(a.offsetParent):a.offsetTop}function NavigateThrough(c){if(!document.getElementById){return}if(window.event){c=window.event}if(c.ctrlKey){var b=null;var a=null;switch(c.keyCode?c.keyCode:c.which?c.which:null){case 37:b=document.getElementById("PrevLink");break;case 39:b=document.getElementById("NextLink");break;case 36:a="/";break}if(b&&b.href){document.location=b.href}if(a){document.location=a}}}function stopEvent(a,b){if(!b){b=window.event}if(b.stopPropagation){b.stopPropagation()}else{b.cancelBubble=true}}(function(c){var b=c.scrollTo=function(e,d,f){c(window).scrollTo(e,d,f)};b.defaults={axis:"xy",duration:parseFloat(c.fn.jquery)>=1.3?0:1,limit:true};b.window=function(d){return c(window)._scrollable()};c.fn._scrollable=function(){return this.map(function(){var e=this,f=!e.nodeName||c.inArray(e.nodeName.toLowerCase(),["iframe","#document","html","body"])!=-1;if(!f){return e}var d=(e.contentWindow||e).document||e.ownerDocument||e;return/webkit/i.test(navigator.userAgent)||d.compatMode=="BackCompat"?d.body:d.documentElement})};c.fn.scrollTo=function(i,h,d){if(typeof h=="object"){d=h;h=0}if(typeof d=="function"){d={onAfter:d}}if(i=="max"){i=9000000000}d=c.extend({},b.defaults,d);h=h||d.duration;d.queue=d.queue&&d.axis.length>1;if(d.queue){h/=2}d.offset=a(d.offset);d.over=a(d.over);return this._scrollable().each(function(){if(i==null){return}var m=this,j=c(m),k=i,g,e={},l=j.is("html,body");switch(typeof k){case"number":case"string":if(/^([+-]=)?\d+(\.\d+)?(px|%)?$/.test(k)){k=a(k);break}k=c(k,this);if(!k.length){return}case"object":if(k.is||k.style){g=(k=c(k)).offset()}}c.each(d.axis.split(""),function(s,q){var o=q=="x"?"Left":"Top",u=o.toLowerCase(),r="scroll"+o,p=m[r],n=b.max(m,q);if(g){e[r]=g[u]+(l?0:p-j.offset()[u]);if(d.margin){e[r]-=parseInt(k.css("margin"+o))||0;e[r]-=parseInt(k.css("border"+o+"Width"))||0}e[r]+=d.offset[u]||0;if(d.over[u]){e[r]+=k[q=="x"?"width":"height"]()*d.over[u]}}else{var t=k[u];e[r]=t.slice&&t.slice(-1)=="%"?parseFloat(t)/100*n:t}if(d.limit&&/^\d+$/.test(e[r])){e[r]=e[r]<=0?0:Math.min(e[r],n)}if(!s&&d.queue){if(p!=e[r]){f(d.onAfterFirst)}delete e[r]}});f(d.onAfter);function f(n){j.animate(e,h,d.easing,n&&function(){n.call(this,i,d)})}}).end()};b.max=function(h,g){var k=g=="x"?"Width":"Height",f="scroll"+k;if(!c(h).is("html,body")){return h[f]-c(h)[k.toLowerCase()]()}var j="client"+k,i=h.ownerDocument.documentElement,e=h.ownerDocument.body;return Math.max(i[f],e[f])-Math.min(i[j],e[j])};function a(d){return typeof d=="object"?d:{top:d,left:d}}})(jQuery);jQuery.cookie=function(b,j,m){if(typeof j!="undefined"){m=m||{};if(j===null){j="";m.expires=-1}var e="";if(m.expires&&(typeof m.expires=="number"||m.expires.toUTCString)){var f;if(typeof m.expires=="number"){f=new Date();f.setTime(f.getTime()+(m.expires*24*60*60*1000))}else{f=m.expires}e="; expires="+f.toUTCString()}var l=m.path?"; path="+(m.path):"";var g=m.domain?"; domain="+(m.domain):"";var a=m.secure?"; secure":"";document.cookie=[b,"=",encodeURIComponent(j),e,l,g,a].join("")}else{var d=null;if(document.cookie&&document.cookie!=""){var k=document.cookie.split(";");for(var h=0;h<k.length;h++){var c=jQuery.trim(k[h]);if(c.substring(0,b.length+1)==(b+"=")){d=decodeURIComponent(c.substring(b.length+1));break}}}return d}};(function(a){var b={minHeight:50,maxHeight:300};a.fn.resizeTextarea=function(d){var c=a.extend({},d,b);a(this).each(function(){var f=a(this),e={setHeight:function(){f.height(c.minHeight);if(f.height()!=getScrollHeight(f)){if(getScrollHeight(f)>c.maxHeight){f.height(c.maxHeight)}else{f.height(getScrollHeight(f)||c.minHeight)}}}};e.setHeight();f.attr({rows:c.minHeight});f.keyup(function(){e.setHeight()})});return a(this)}})(jQuery);function getScrollHeight(b){b.scrollTop(b.get(0).scrollHeight);var a=b.scrollTop()+b.height();b.scrollTop(0);return a}function openPrintWindow(b){var d=$(".recipe");var f=d.find(".title");var c=d.find(".instructions");var e=[];var i=[["Первый","Второй","Третий","Четвёртый","Пятый","Шестой","Седьмой","Восьмой","Девятый"],["Одиннадцатый","Двенадцатый","Тринадцатый","Четырнадцатый","Пятнадцатый","Шестнадцатый","Семнадцатый","Восемнадцатый","Девятнадцатый"],["Десятый","Двадцатый","Тридцатый","Сороковой","Пятидесятый","Шестидесятый","Семидесятый","Восьмидесятый","Девяностый"],["","Двадцать","Тридцать","Сорок","Пятьдесят","Шестьдесят","Семьдесят","Восемьдесят","Девяносто"],["первый","второй","третий","четвёртый","пятый","шестой","седьмой","восьмой","девятый"]];c.find(".stage").each(function(){var j=$("<div></div>").html($(this).html());j.find(".body").append('<div class="i-clearfix"></div>');var k=j.find(".image");k.html(g(k.html()));e.push(j.html())});var h=window.open("","printWindow","width=800, height=800,toolbar=0,scrollbars=yes,status=0,directories=0,location=0,menubar=0,resizable=0");h.document.write(a());function g(o){var m=$("<div></div>").html(o);var l=m.find("img");var p=m.find(".screen");var r=p.children("div");var k=parseInt(r.css("width"));var s=parseInt(r.css("height"));var q=200/k;var n=k*q;var j=s*q;r.css({width:k*q+"px",height:s*q+"px"});l.attr({width:k*q,height:s*q});return m.html()}function a(){var j={browser:$.browser,title:$("title").text(),h1:$("h1").text(),recipeInfo:d.find(".recipe_info").html(),needed:f.find(".needed").find("table").html(),titleImage:g(f.find(".image").html()),description:d.find(".description").html(),stages:e};var k=document.getElementById("print-recipe").innerHTML;var l=tmpl(k);return l(j)}}function esc(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")}function tmpl(c){var a="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+c.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(/<%-([\s\S]+?)%>/g,function(d,e){return"',esc("+e.replace(/\\'/g,"'")+"),'"}).replace(/<%=([\s\S]+?)%>/g,function(d,e){return"',"+e.replace(/\\'/g,"'")+",'"}).replace(/<%([\s\S]+?)%>/g,function(d,e){return"');"+e.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+";__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');";var b=new Function("obj",a);return function(d){return b.call(this,d)}}jQuery.fn.addtocopy=function(b){var a={htmlcopytxt:'<br>More: <a href="'+window.location.href+'">'+window.location.href+"</a><br>",minlen:25,addcopyfirst:false};$.extend(a,b);var c=document.createElement("span");c.id="ctrlcopy";c.innerHTML=a.htmlcopytxt;return this.each(function(){$(this).mousedown(function(){$("#ctrlcopy").remove()});$(this).mouseup(function(){if(window.getSelection){var e=window.getSelection();var d=e.toString();if(!d||d.length<a.minlen){return}var f=e.getRangeAt(0);d=f.cloneRange();d.collapse(a.addcopyfirst);d.insertNode(c);if(!a.addcopyfirst){f.setEndAfter(c)}e.removeAllRanges();e.addRange(f)}else{if(document.selection){var e=document.selection;var f=e.createRange();var d=f.text;if(!d||d.length<a.minlen){return}d=f.duplicate();d.collapse(a.addcopyfirst);d.pasteHTML(c.outerHTML);if(!a.addcopyfirst){f.setEndPoint("EndToEnd",d);f.select()}}}})})};function DoYouKnowThat(e){var a=this;d();function d(){if(!document.getElementById(e)){return false}a.$elem=$("#"+e);c()}function c(){f();function f(){a.$elem.find(".b-facts__more__link").click(g);function g(){if(!a.factsArray){i();return false}b();h();function i(){$.getJSON("/php/get_more_facts.php",j);function j(l,m,k){a.factsArray=l.facts;b()}}function h(){if(!window.ga){return}ga("send","event","Знаете ли вы что","Нажали кнопку Еще",a.$elem.find(".b-facts__item").text())}return false}}}function b(){if(!a.factsArray){a.$elem.find(".b-facts__more__link").click();return false}var f=h();g();function g(){a.$elem.find(".b-facts__item").fadeOut(500,function(){a.$elem.find(".b-facts__item").attr({"data-id":f.id}).html(f.text).fadeIn(500)})}function h(){var i={id:a.$elem.find(".b-facts__item").attr("data-id"),text:a.$elem.find(".b-facts__item").text()};while(a.factsArray[0].id==i.id){k()}var j=a.factsArray[0];k();function k(){a.factsArray.push(a.factsArray.shift())}return j}}}function FilterRecipes(){var a=this;c();function c(){b()}function b(){$("#filter_recipes").delegate(".item a","click",d);function d(){var h=$(this),e=4,g=i(),k=f(g);j();function i(){var l=h.parent()[0].className.split(/\s*item\s*/);for(var m=0;m<l.length;m++){if(l[m]!=""){l=l[m];break}}return l}function f(l){switch(l){case"cuisine":return cuisineArray;case"dish":return dishTypeArray;case"ingredient":return mainIngredientArray;case"tag":return tagArray}return cuisineArray}function j(){if(h.hasClass("open")){$("#filter_list").slideUp("middle").empty();h.removeClass("open");document.getElementById("filter_list").className="";return}var o="",m=Math.ceil(k[1].length/e);o+='<div class="pad"><table>';for(var n=0;n<m;n++){o+="<tr>";for(var l=0;l<e;l++){x=m*l+n;if(k[0][x]){o+='<td><a href="#" rel="'+k[0][x]+'">'+k[1][x]+"</a></td>"}else{o+="<td><span></span></td>"}}o+="</tr>"}o+="</table></div>";$("#filter_list").html(o).slideDown("middle");$("#filter_recipes .item a").removeClass("open");h.addClass("open");document.getElementById("filter_list").className=g}return false}}}function Filter(b){var a=this;d();function d(){a.$elem=b;a.$lists=a.$elem.find(".b-filter__lists");a.$list=a.$elem.find(".b-filter__list");c()}function c(){b.delegate(".b-filter__item__button","click",e);function e(){var g=$(this),f=parseInt(a.$elem.attr("data-col"),10),i=window[g.closest(".b-filter__item").attr("data-array")];if(g.hasClass("open")){a.$list.slideUp("middle").empty();g.removeClass("open")}else{h()}function h(){var n="",l=Math.ceil(i.length/f);n+='<div class="pad"><table>';for(var m=0;m<l;m++){n+="<tr>";for(var k=0;k<f;k++){x=l*k+m;if(i[x]){n+='<td><a href="#" rel="'+i[x].id+'">'+i[x].name+"</a></td>"}else{n+="<td><span></span></td>"}}n+="</tr>"}n+="</table></div>";a.$list.html(n).slideDown("middle");a.$elem.find(".b-filter__item__button").removeClass("open");g.addClass("open")}return false}}}function FilterList(){var m=this;m.recipesPerPage=27;m.makeRequest=true;r();function r(){if(!document.getElementById("filter_list")){return false}p();s()}function p(){var u=y();v(u);w(u);function y(){var A=C();var z={};for(var B in A){if(B=="cuisine"||B=="dish"||B=="ingredient"||B=="tag"){z.type=B;z.data=A[B]}}z.num=A.num;return z;function C(){var F=window.location.search;var E=/([a-z0-9]+)=([a-z0-9]+)/gi;var G;var D={};while((G=E.exec(F))!=null){D[G[1]]=G[2]}return D}}function v(z){var C={};for(var A in z){C[A]=z[A]}if(!C.num){C.num=$("#recipe_feed_block .recipe_list_item").size()}C.allRecipesNum=parseInt($("#fc_statistics span.num").text(),10);C.recipes=a();var B=window.History;if(!B.enabled){return}B.pushState(C)}function w(z){if(z.type&&z.data){n(z.type,z.data,z.num,true)}else{if(z.num){d(z.num,true)}}}}function s(){$("#filter_list").click(function(u){u.stopPropagation()}).delegate("a","click",q);o();$("#get_more_recipes a").click(l)}function q(){var v=document.getElementById("filter_list").className,u=this.getAttribute("rel");n(v,u);$("#filter_list").hide().empty();return false}function n(A,z,u,w){var y=m.recipesPerPage;if(u){y=u}$.ajax({url:"/php/all_recipes_result.php",dataType:"json",data:"num="+y+"&type="+A+"&data="+z,beforeSend:v,success:B});function v(){k()}function B(D){allRecipesResult=D.id;var C=parseInt(allRecipesResult.length,10)+parseInt(D.recipes.length,10);m.makeRequest=false;f({type:A,data:z,num:D.recipes.length,recipes:D.recipes,allRecipesNum:C},w);setTimeout(function(){i(window.History.getState())},0)}}function d(u,w){var y=m.recipesPerPage;if(u){y=u}$.ajax({url:"/php/last_recipes_result.php",dataType:"json",data:"num="+y,beforeSend:v,success:z});function v(){k()}function z(B){var A=parseInt(B.id.length,10)+parseInt(B.recipes.length,10);m.makeRequest=false;f({num:B.recipes.length,recipes:B.recipes,allRecipesNum:A},w);setTimeout(function(){i(window.History.getState())},0)}}function k(){$("#recipe_feed_block").empty().html('<div class="preloader"><img src="/images/preloader.gif" width="281" height="52" alt="" /></div>')}function l(){var u=[];for(var v=0;v<m.recipesPerPage;v++){if(allRecipesResult[0]){u[v]=allRecipesResult.shift()}}$.ajax({url:"/php/get_more_recipes.php",dataType:"json",data:"id="+u,beforeSend:function(){$("#get_more_recipes").addClass("preload")},success:function(A){$("#get_more_recipes").removeClass("preload");var B=$('<div class="block" style="display:none;"></div>');var z="";for(var y=0;y<A.recipes.length;y++){z+='<div class="item recipe_list_item"><div class="photo"><a href="'+A.recipes[y].href+'" title="'+A.recipes[y].name+'"><img src="'+A.recipes[y].src+'" width="170" alt="'+A.recipes[y].name+'" /></a></div><h5><a href="'+A.recipes[y].href+'">'+A.recipes[y].name+'</a></h5><p class="author">От: '+A.recipes[y].author+'</p><p class="info"><span class="comments_icon" title="Оставить отзыв"><noindex><a href="'+A.recipes[y].href+'#comments">'+A.recipes[y].comments+"</a></noindex></span></p></div>"}B.html(z);$("#recipe_feed_block").find("div.clear").before(B).end().find("div.block:last div.recipe_list_item div.photo a").each(function(){var E=$(this),D=E.children("img"),C=new Image();C.src=D.attr("src");var F=Math.floor(C.height*D.attr("width")/C.width);if(F>0){D.css({marginTop:(parseInt(E.css("height"))/2-F/2)+"px"})}else{D.load(function(){var G=Math.floor(C.height*D.attr("width")/C.width);if(G>0){D.css({marginTop:(parseInt(E.css("height"))/2-G/2)+"px"})}})}}).end().find("div.block:last").css({opacity:0}).show().animate({opacity:1},500);$.scrollTo($("#recipe_feed_block div.block:last div.item:first"),1000);w(A);h();window.upButton.styleElements()}});return false;function w(y){var A=window.History;if(!A.enabled){return}m.makeRequest=false;var z=A.getState();z.data.num=$("#recipe_feed_block .recipe_list_item").size();if(z.data.recipes&&y.recipes){z.data.recipes=z.data.recipes.concat(y.recipes)}f(z.data,false)}}function f(u,w){var y=window.History;if(!y.enabled){return}var z=v();if(w){y.replaceState(u,"Рецепты",z);return}y.pushState(u,"Рецепты",z);function v(){var A=[];if(u.type&&u.data){A.push(u.type+"="+u.data)}A.push("num="+u.num);A=A.join("&");if(A!=""){A="?"+A}return A}}function o(){var u=window.History;if(!u.enabled){return}u.Adapter.bind(window,"statechange",function(){if(m.makeRequest){var v=u.getState();if(v.data.recipes){i(v)}else{n(null,null)}}m.makeRequest=true})}function i(u){if(u.data.type&&u.data.data){var w=e(u.data.type);var v=t(w,u.data.data);j($("."+u.data.type+" a"),v)}else{j($(),"")}g(u.data.recipes);c(u.data.allRecipesNum);b();h()}function h(){var v=window.History;if(v.enabled){var u=v.getState();var w=u.data.allRecipesNum-u.data.recipes.length}else{var w=allRecipesResult.length}if(w==0){$("#get_more_recipes").hide()}else{$("#get_more_recipes").show()}}function b(){$("#topbar div.item").each(function(){if($(this).text()=="Рецепты"){if(window.search&&window.search!=""){$(this).html('<a href="'+window.pathname+'"><span>Рецепты</span></a>')}else{$(this).html("<span><span>Рецепты</span></span>")}}})}function e(u){switch(u){case"cuisine":return cuisineArray;case"dish":return dishTypeArray;case"ingredient":return mainIngredientArray;case"tag":return tagArray}}function t(w,v){for(var u=0;u<w[0].length;u++){if(w[0][u]==v){return w[1][u]}}}function g(w){var v="";for(var u=0;u<w.length;u++){v+='<div class="item recipe_list_item"><div class="photo"><a href="'+w[u].href+'" title="'+w[u].name+'"><img src="'+w[u].src+'" width="170" alt="'+w[u].name+'" /></a></div><h5><a href="'+w[u].href+'">'+w[u].name+'</a></h5><p class="author">От: '+w[u].author+'</p><p class="info"><span class="comments_icon" title="Оставить отзыв"><noindex><a href="'+w[u].href+'#comments">'+w[u].comments+"</a></noindex></span></p></div>"}v+='<div class="clear"></div>';$("#recipe_feed_block").html(v).find("div.recipe_list_item div.photo a").each(function(){var A=$(this),z=A.children("img"),y=new Image();y.src=z.attr("src");var B=Math.floor(y.height*z.attr("width")/y.width);if(B>0){z.css({marginTop:(parseInt(A.css("height"))/2-B/2)+"px"})}else{z.load(function(){var C=Math.floor(y.height*z.attr("width")/y.width);if(C>0){z.css({marginTop:(parseInt(A.css("height"))/2-C/2)+"px"})}})}})}function j(u,v){$("#filter_recipes a.active").removeClass("active").find("span.bg span").text("—");u.removeClass("open").addClass("active").find("span.bg span").text(v)}function a(){var u=[];$("#recipe_feed_block div.item").each(function(){var v=$(this);u.push({name:v.find("h5 a").text(),href:v.find("h5 a").attr("href"),src:v.find("img").attr("src"),author:v.find(".author").text().substring(4),comments:v.find(".comments_icon a").text()})});return u}function c(v){$("#fc_statistics").find("span.num").text(v).end().find("span.word").text(u(v));function u(w){if(/(10|11|12|13|14|15|16|17|18|19)$/.test(w)){return"рецептов"}else{if(/.*1$/.test(w)){return"рецепт"}else{if(/[2-4]$/.test(w)){return"рецепта"}else{return"рецептов"}}}}}}function valignRecipePreviewPhoto(){$("div.recipe_list_item div.photo a, .b-recipe-preview__photo__link").each(function(){var c=$(this),b=c.children("img"),a=new Image();a.src=b.attr("src");var d=Math.floor(a.height*b.attr("width")/a.width);if(d>0){b.css({marginTop:(parseInt(c.css("height"))/2-d/2)+"px"})}else{b.load(function(){var e=Math.floor(a.height*b.attr("width")/a.width);if(e>0){b.css({marginTop:(parseInt(c.css("height"))/2-e/2)+"px"})}})}})}function favoriteButtons(){$(".b-favorite-button").hover(function(){$(this).addClass("i-hover").stop().animate({width:"79px"},function(){$(this).find(".b-favorite-button__text").css({display:"inline-block"})})},function(){$(this).find(".b-favorite-button__text").hide();$(this).stop().animate({width:"35px"},function(){$(this).removeClass("i-hover")})}).click(a);function a(){if(!window.ga){return}var b=$(this);if(b.hasClass("i-remove-favorite")){_gaq.push(["_trackEvent","Избранное","Удалили из избранного"]);ga("send","event","Избранное","Удалили из избранного")}else{_gaq.push(["_trackEvent","Избранное","Добавили в избранное"]);ga("send","event","Избранное","Добавили в избранное")}}}function ajaxError(e,d,f){if(window.console){console.log(e);console.log(d);console.log(f)}};